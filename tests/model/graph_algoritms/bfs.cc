#include <gtest/gtest.h>

#include <string>
#include <vector>

#include "../../../src/model/graph/graph.h"
#include "../../../src/model/graph_algorithms/graph_algorithms.h"
#include "matrix.h"

struct BFSDataTest {
  std::string filename_;
  graph::Graph::Vertex start_vertex_;
  std::vector<graph::Graph::Vertex> vertices_;
};

class BFSTest : public testing::TestWithParam<int> {
 public:
  static int count_;
  static std::vector<BFSDataTest> test_data_;
};

int BFSTest::count_ = 47;
std::vector<BFSDataTest> BFSTest::test_data_ = {
    BFSDataTest{"graphs/1.txt", 1, {1, 2, 3, 4, 5}},
    BFSDataTest{"graphs/1.txt", 2, {2, 1, 3, 5, 4}},
    BFSDataTest{"graphs/1.txt", 3, {3, 1, 2, 5, 4}},
    BFSDataTest{"graphs/1.txt", 4, {4, 1, 5, 2, 3}},
    BFSDataTest{"graphs/1.txt", 5, {5, 2, 3, 4, 1}},
    BFSDataTest{"graphs/2.txt", 1, {1, 2, 3, 4, 7, 6, 5, 8, 9}},
    BFSDataTest{"graphs/2.txt", 2, {2, 1, 3, 4, 6, 7, 5, 8, 9}},
    BFSDataTest{"graphs/2.txt", 3, {3, 1, 2, 4, 7, 6, 5, 8, 9}},
    BFSDataTest{"graphs/2.txt", 4, {4, 1, 2, 3, 5, 6, 7, 8, 9}},
    BFSDataTest{"graphs/2.txt", 5, {5, 4, 7, 8, 1, 2, 3, 6, 9}},
    BFSDataTest{"graphs/2.txt", 6, {6, 2, 4, 8, 9, 1, 3, 7, 5}},
    BFSDataTest{"graphs/2.txt", 7, {7, 1, 2, 5, 3, 4, 6, 8, 9}},
    BFSDataTest{"graphs/2.txt", 8, {8, 5, 6, 9, 4, 7, 2, 1, 3}},
    BFSDataTest{"graphs/2.txt", 9, {9, 6, 8, 2, 4, 5, 1, 3, 7}},
    BFSDataTest{"graphs/3.txt", 1, {1, 2, 6, 3, 5, 4}},
    BFSDataTest{"graphs/3.txt", 2, {2, 1, 3, 6, 4, 5}},
    BFSDataTest{"graphs/3.txt", 3, {3, 2, 4, 1, 5, 6}},
    BFSDataTest{"graphs/3.txt", 4, {4, 3, 5, 2, 6, 1}},
    BFSDataTest{"graphs/3.txt", 5, {5, 4, 6, 3, 1, 2}},
    BFSDataTest{"graphs/3.txt", 6, {6, 1, 5, 2, 4, 3}},
    BFSDataTest{"graphs/4.txt", 1, {1, 2, 3, 4, 5, 6}},
    BFSDataTest{"graphs/4.txt", 2, {2, 1, 3, 5, 4, 6}},
    BFSDataTest{"graphs/4.txt", 3, {3, 1, 2, 4, 5, 6}},
    BFSDataTest{"graphs/4.txt", 4, {4, 1, 3, 6, 2, 5}},
    BFSDataTest{"graphs/4.txt", 5, {5, 1, 2, 3, 4, 6}},
    BFSDataTest{"graphs/4.txt", 6, {6, 1, 4, 2, 3, 5}},
    BFSDataTest{"graphs/5.txt", 1, {1, 2, 3, 4}},
    BFSDataTest{"graphs/5.txt", 2, {2, 3, 4, 1}},
    BFSDataTest{"graphs/5.txt", 3, {3, 1, 2, 4}},
    BFSDataTest{"graphs/5.txt", 4, {4, 1, 3, 2}},
    BFSDataTest{"graphs/6.txt",
                11,
                {11, 4,   68,  69,  1,  12, 13, 14, 79, 80, 81, 82, 83, 84, 2,
                 3,  70,  71,  72,  73, 74, 75, 76, 77, 78, 5,  6,  7,  8,  9,
                 10, 85,  86,  87,  89, 88, 90, 91, 92, 93, 94, 97, 95, 96, 98,
                 99, 100, 101, 102, 15, 18, 19, 26, 27, 28, 29, 38, 39, 40, 48,
                 49, 50,  51,  52,  16, 17, 20, 21, 22, 23, 24, 25, 30, 31, 32,
                 33, 34,  35,  36,  37, 41, 42, 43, 44, 45, 46, 47, 53, 54, 55,
                 56, 57,  58,  59,  60, 61, 62, 63, 64, 65, 66, 67}},
    BFSDataTest{"graphs/6.txt",
                44,
                {44, 39, 8,  43, 45, 2,  38, 40, 1,  5,   6,   7,  41, 42, 46,
                 47, 3,  4,  15, 18, 19, 26, 27, 28, 29,  9,   10, 11, 12, 13,
                 14, 16, 17, 20, 21, 22, 23, 24, 25, 30,  31,  32, 33, 34, 35,
                 36, 37, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                91,
                {91, 73,  13,  92,  93, 4,  74, 75, 76, 1,  11, 12, 14, 94, 97,
                 95, 96,  2,   3,   68, 69, 70, 71, 72, 77, 78, 5,  6,  7,  8,
                 9,  10,  79,  80,  81, 82, 83, 84, 85, 86, 87, 89, 88, 90, 98,
                 99, 100, 101, 102, 15, 18, 19, 26, 27, 28, 29, 38, 39, 40, 48,
                 49, 50,  51,  52,  16, 17, 20, 21, 22, 23, 24, 25, 30, 31, 32,
                 33, 34,  35,  36,  37, 41, 42, 43, 44, 45, 46, 47, 53, 54, 55,
                 56, 57,  58,  59,  60, 61, 62, 63, 64, 65, 66, 67}},
    BFSDataTest{"graphs/6.txt",
                102,
                {102, 78, 14, 101, 4,  77, 1,  11, 12, 13, 98, 99, 100, 2,  3,
                 68,  69, 70, 71,  72, 73, 74, 75, 76, 5,  6,  7,  8,   9,  10,
                 79,  80, 81, 82,  83, 84, 85, 86, 87, 89, 88, 90, 91,  92, 93,
                 94,  97, 95, 96,  15, 18, 19, 26, 27, 28, 29, 38, 39,  40, 48,
                 49,  50, 51, 52,  16, 17, 20, 21, 22, 23, 24, 25, 30,  31, 32,
                 33,  34, 35, 36,  37, 41, 42, 43, 44, 45, 46, 47, 53,  54, 55,
                 56,  57, 58, 59,  60, 61, 62, 63, 64, 65, 66, 67}},
    BFSDataTest{"graphs/6.txt",
                35,
                {35, 28, 7,  34, 2,  26, 27, 29, 1,  5,   6,   8,  30, 31, 32,
                 33, 36, 37, 3,  4,  15, 18, 19, 38, 39,  40,  9,  10, 11, 12,
                 13, 14, 16, 17, 20, 21, 22, 23, 24, 25,  41,  42, 43, 44, 45,
                 46, 47, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                17,
                {17, 15, 5,  16, 2,  1,  6,  7,  8,  3,   4,   18, 19, 26, 27,
                 28, 29, 38, 39, 40, 9,  10, 11, 12, 13,  14,  20, 21, 22, 23,
                 24, 25, 30, 31, 32, 33, 34, 35, 36, 37,  41,  42, 43, 44, 45,
                 46, 47, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                8,
                {8,  2,  38, 39, 40, 1,  5,  6,  7,  41,  42,  43, 44, 45, 46,
                 47, 3,  4,  15, 18, 19, 26, 27, 28, 29,  9,   10, 11, 12, 13,
                 14, 16, 17, 20, 21, 22, 23, 24, 25, 30,  31,  32, 33, 34, 35,
                 36, 37, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                1,
                {1,  2,  3,  4,  5,  6,  7,  8,  9,  10,  11,  12, 13, 14, 15,
                 18, 19, 26, 27, 28, 29, 38, 39, 40, 48,  49,  50, 51, 52, 68,
                 69, 70, 71, 72, 73, 74, 75, 76, 77, 78,  16,  17, 20, 21, 22,
                 23, 24, 25, 30, 31, 32, 33, 34, 35, 36,  37,  41, 42, 43, 44,
                 45, 46, 47, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                15,
                {15, 5,  16, 17, 2,  1,  6,  7,  8,  3,   4,   18, 19, 26, 27,
                 28, 29, 38, 39, 40, 9,  10, 11, 12, 13,  14,  20, 21, 22, 23,
                 24, 25, 30, 31, 32, 33, 34, 35, 36, 37,  41,  42, 43, 44, 45,
                 46, 47, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                7,
                {7,  2,  26, 27, 28, 29, 1,  5,  6,  8,   30,  31, 32, 33, 34,
                 35, 36, 37, 3,  4,  15, 18, 19, 38, 39,  40,  9,  10, 11, 12,
                 13, 14, 16, 17, 20, 21, 22, 23, 24, 25,  41,  42, 43, 44, 45,
                 46, 47, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                68,
                {68, 11,  79,  80,  81, 4,  69, 1,  12, 13, 14, 82, 83, 84, 2,
                 3,  70,  71,  72,  73, 74, 75, 76, 77, 78, 5,  6,  7,  8,  9,
                 10, 85,  86,  87,  89, 88, 90, 91, 92, 93, 94, 97, 95, 96, 98,
                 99, 100, 101, 102, 15, 18, 19, 26, 27, 28, 29, 38, 39, 40, 48,
                 49, 50,  51,  52,  16, 17, 20, 21, 22, 23, 24, 25, 30, 31, 32,
                 33, 34,  35,  36,  37, 41, 42, 43, 44, 45, 46, 47, 53, 54, 55,
                 56, 57,  58,  59,  60, 61, 62, 63, 64, 65, 66, 67}},
    BFSDataTest{"graphs/6.txt",
                84,
                {84, 69,  11,  82,  83, 4,  68, 1,  12, 13, 14, 79, 80, 81, 2,
                 3,  70,  71,  72,  73, 74, 75, 76, 77, 78, 5,  6,  7,  8,  9,
                 10, 85,  86,  87,  89, 88, 90, 91, 92, 93, 94, 97, 95, 96, 98,
                 99, 100, 101, 102, 15, 18, 19, 26, 27, 28, 29, 38, 39, 40, 48,
                 49, 50,  51,  52,  16, 17, 20, 21, 22, 23, 24, 25, 30, 31, 32,
                 33, 34,  35,  36,  37, 41, 42, 43, 44, 45, 46, 47, 53, 54, 55,
                 56, 57,  58,  59,  60, 61, 62, 63, 64, 65, 66, 67}},
    BFSDataTest{"graphs/6.txt",
                19,
                {19, 6,  23, 24, 25, 2,  18, 1,  5,  7,   8,   20, 21, 22, 3,
                 4,  15, 26, 27, 28, 29, 38, 39, 40, 9,   10,  11, 12, 13, 14,
                 16, 17, 30, 31, 32, 33, 34, 35, 36, 37,  41,  42, 43, 44, 45,
                 46, 47, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                20,
                {20, 18, 6,  21, 22, 2,  19, 1,  5,  7,   8,   23, 24, 25, 3,
                 4,  15, 26, 27, 28, 29, 38, 39, 40, 9,   10,  11, 12, 13, 14,
                 16, 17, 30, 31, 32, 33, 34, 35, 36, 37,  41,  42, 43, 44, 45,
                 46, 47, 48, 49, 50, 51, 52, 68, 69, 70,  71,  72, 73, 74, 75,
                 76, 77, 78, 53, 54, 55, 56, 57, 58, 59,  60,  61, 62, 63, 64,
                 65, 66, 67, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/6.txt",
                51,
                {51, 10, 61, 62, 63, 3,  52, 1,  9,  64,  65,  66, 67, 2,  4,
                 48, 49, 50, 5,  6,  7,  8,  11, 12, 13,  14,  53, 54, 55, 56,
                 57, 58, 59, 60, 15, 18, 19, 26, 27, 28,  29,  38, 39, 40, 68,
                 69, 70, 71, 72, 73, 74, 75, 76, 77, 78,  16,  17, 20, 21, 22,
                 23, 24, 25, 30, 31, 32, 33, 34, 35, 36,  37,  41, 42, 43, 44,
                 45, 46, 47, 79, 80, 81, 82, 83, 84, 85,  86,  87, 89, 88, 90,
                 91, 92, 93, 94, 97, 95, 96, 98, 99, 100, 101, 102}},
    BFSDataTest{"graphs/7.txt",
                27,
                {27, 2,  10, 22, 46, 6,  8,  19, 9,  20, 23, 1,  4,  7,  17, 3,
                 11, 21, 24, 33, 16, 14, 5,  13, 12, 34, 51, 54, 29, 15, 18, 25,
                 31, 35, 36, 28, 32, 26, 48, 39, 30, 52, 53, 37, 40, 43, 38}},
    BFSDataTest{"graphs/7.txt", 42, {42, 44, 47, 49, 50, 41, 45}}};

INSTANTIATE_TEST_SUITE_P(BFS, BFSTest, testing::Range(0, BFSTest::count_));

TEST_P(BFSTest, Common) {
  int num_test = this->GetParam();
  BFSDataTest& data = BFSTest::test_data_[num_test];

  graph::Graph graph;
  graph.LoadGraphFromFile(data.filename_);

  graph::GraphAlgorithms alg;

  std::vector<graph::Graph::Vertex> vertices =
      alg.BreadthFirstSearch(graph, data.start_vertex_);

  EXPECT_EQ(vertices.size(), data.vertices_.size());

  for (size_t i = 0; i < vertices.size(); ++i) {
    EXPECT_EQ(vertices[i], data.vertices_[i]);
  }
}
